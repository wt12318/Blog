---
title: 【Ch6】Hands on Machine Learning 决策树
author: wutao
date: '2021-03-04'
slug: ch6_hands_on_ML
categories:
  - python
  - reading notes
tags:
  - notes
image : "image1.jpg"
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>决策树是一种多能的机器学习算法，可以处理分类，回归，甚至多输出问题(见第二章)</p>
<p>参考资料：<a href="https://www.bilibili.com/video/BV1ut41197F6?from=search&amp;seid=9344266940719140153" class="uri">https://www.bilibili.com/video/BV1ut41197F6?from=search&amp;seid=9344266940719140153</a></p>
<p><a href="https://www.bilibili.com/video/BV1ZK4y1b7Xt" class="uri">https://www.bilibili.com/video/BV1ZK4y1b7Xt</a></p>
<p><a href="https://www.bilibili.com/video/BV1MA411J7wm" class="uri">https://www.bilibili.com/video/BV1MA411J7wm</a></p>
<p>李航统计学习</p>
<div id="训练和可视化决策树" class="section level2">
<h2>训练和可视化决策树</h2>
<p>首先在iris数据集上训练一个决策树模型并可视化：</p>
<pre class="python"><code>from sklearn.datasets import load_iris
from sklearn.tree import DecisionTreeClassifier
from sklearn import tree
from matplotlib import pyplot as plt

iris = load_iris()
x = iris.data[:,2:]##取petal length和width变量
y = iris.target

tree_clf = DecisionTreeClassifier(max_depth=2)
tree_clf.fit(x,y)
&gt;&gt; DecisionTreeClassifier(max_depth=2)</code></pre>
<p>Graphviz是一个开源的图（Graph）可视化软件，采用抽象的图和网络来表示结构化的信息。在数据科学领域，Graphviz的一个用途就是实现决策树可视化,因此我们需要使用<code>export_graphviz()</code>将树结构导出为一个<code>.dot</code>文件</p>
<pre class="python"><code>from sklearn.tree import export_graphviz
from graphviz import Source

export_graphviz(
  tree_clf,
  out_file=&quot;../test/iris_tree.dot&quot;,
  feature_names=iris.feature_names[2:],
  class_names=iris.target_names,
  rounded=True,
  filled=True,
  special_characters=True
)</code></pre>
<p>然后需要下载<a href="https://www.graphviz.org/download/">Graphviz</a>,打开powershell：</p>
<pre class="shell"><code>dot -Tpng iris_tree.dot -o iris_tree.png</code></pre>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/iris_tree.png" /></p>
</div>
